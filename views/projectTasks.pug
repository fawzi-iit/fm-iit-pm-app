extends layout

block content
  h1 Tasks for #{project.name}
  ul
    each task in tasks
      li
        div
          strong Title: 
          | #{task.title}
        div
          strong Description: 
          | #{task.description}
        div
          strong Priority: 
          | #{task.priority}
        div
          strong Status: 
          | #{task.status}
        div
          strong Progress: 
          | #{task.progress}%
        div
          if task.assignee
            strong Assignee: 
            | #{task.assignee.name} // Adjust based on your user model
          else
            | Assignee: Not assigned
        br
        // Replace the form with a delete button
        button.delete-button(onclick="confirmDelete('#{task._id}')") Delete Task
  a(href=`/projects/${project._id}/tasks/new`) Add New Task

script.
  function confirmDelete(taskId) {
    if (confirm("Are you sure you want to delete this task?")) {
      deleteTask(taskId);
    }
  }

  function deleteTask(taskId) {
    fetch(`/tasks/${taskId}`, {
      method: 'DELETE'
    })
    .then(response => {
      if (!response.ok) {
        throw new Error('Network response was not ok');
      }
      // Optionally, remove the task from the DOM or refresh the task list
      console.log("Task deleted:", taskId);
      // Example: document.querySelector(`#task-${taskId}`).remove();
    })
    .catch(error => console.error('Error:', error));
  }
